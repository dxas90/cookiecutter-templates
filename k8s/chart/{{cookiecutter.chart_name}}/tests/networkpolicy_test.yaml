suite: test network policy
templates:
  - networkpolicy.yaml
tests:
  - it: should create NetworkPolicy
    asserts:
      - isKind:
          of: NetworkPolicy
      - equal:
          path: metadata.name
          value: RELEASE-NAME-{{ cookiecutter.chart_name }}
      - equal:
          path: metadata.labels["app.kubernetes.io/part-of"]
          value: {{ cookiecutter.chart_label }}

  - it: should have correct pod selector
    asserts:
      - isSubset:
          path: spec.podSelector
          content:
            matchLabels: {}

  - it: should include correct labels
    asserts:
      - isSubset:
          path: metadata.labels
          content:
            app.kubernetes.io/name: {{ cookiecutter.chart_name }}
            app.kubernetes.io/instance: RELEASE-NAME
